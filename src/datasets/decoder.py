from __future__ import absolute_import
from __future__ import division
from __future__ import print_function
import numpy as np


def pkexample_type_original(patch_sd, patch_sd_ma5, patch_sd_ma10, patch_sd_ma20, patch_sd_ma60,
                            patch_sd_diff, patch_sd_diff_ma5, patch_sd_diff_ma10, patch_sd_diff_ma20,
                            patch_sd_diff_ma60,
                            patch_sd_velocity, patch_sd_velocity_ma5, patch_sd_velocity_ma10, patch_sd_velocity_ma20,
                            patch_sd_velocity_ma60,
                            patch_historical_ar, patch_historical_ar_ma5, patch_historical_ar_ma10,
                            patch_historical_ar_ma20,
                            patch_historical_ar_ma60,
                            patch_fund_his_30, patch_cov_60, patch_extra_cov_60, mask_reader):
    feature = {
        # 'structure/data': patch_sd.data,
        # 'structure/data_max': sd_max,
        # 'structure/data_min': sd_min,
        # 'structure/data_ma5': patch_sd_ma5.data,
        # 'structure/data_ma10': patch_sd_ma10.data,
        # 'structure/data_ma20': patch_sd_ma20.data,
        # 'structure/data_ma60': patch_sd_ma60.data,
        # 'structure/normal': patch_sd.normal_data,
        # 'structure/normal_ma5': patch_sd_ma5.normal_data,
        # 'structure/normal_ma10': patch_sd_ma10.normal_data,
        # 'structure/normal_ma20': patch_sd_ma20.normal_data,
        # 'structure/normal_ma60': patch_sd_ma60.normal_data,
        # 'structure/diff': patch_sd_diff.normal_data,
        # 'structure/diff_ma5': patch_sd_diff_ma5.normal_data,
        # 'structure/diff_ma10': patch_sd_diff_ma10.normal_data,
        # 'structure/diff_ma20': patch_sd_diff_ma20.normal_data,
        # 'structure/diff_ma60': patch_sd_diff_ma60.normal_data,
        # 'structure/velocity': patch_sd_velocity.normal_data,
        # 'structure/velocity_ma5': patch_sd_velocity_ma5.normal_data,
        # 'structure/velocity_ma10': patch_sd_velocity_ma10.normal_data,
        # 'structure/velocity_ma20': patch_sd_velocity_ma20.normal_data,
        # 'structure/velocity_ma60': patch_sd_velocity_ma60.normal_data,
        # 'structure/ar': patch_historical_ar.data,
        # 'structure/ar_ma5': patch_historical_ar_ma5.data,
        # 'structure/ar_ma10': patch_historical_ar_ma10.data,
        # 'structure/ar_ma20': patch_historical_ar_ma20.data,
        # 'structure/ar_ma60': patch_historical_ar_ma60.data,
        # 'structure/extra_cov': patch_extra_cov_60.data,
        # 'structure/height': patch_sd.height,
        # 'structure/width': patch_sd.width,

        # # predefined_observation for open-ai environments
        # 'structure/predefined_observation': np.concatenate((patch_sd.normal_data,
        #                                                     patch_sd_ma5.normal_data,
        #                                                     patch_sd_ma10.normal_data,
        #                                                     patch_sd_ma20.normal_data,
        #                                                     patch_sd_ma60.normal_data), axis=0). \
        #     reshape((5, patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])),
        # 'structure/predefined_observation_diff': np.concatenate((patch_sd_diff.normal_data,
        #                                                          patch_sd_diff_ma5.normal_data,
        #                                                          patch_sd_diff_ma10.normal_data,
        #                                                          patch_sd_diff_ma20.normal_data,
        #                                                          patch_sd_diff_ma60.normal_data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        # 'structure/predefined_observation_velocity': np.concatenate((patch_sd_velocity.normal_data,
        #                                                              patch_sd_velocity_ma5.normal_data,
        #                                                              patch_sd_velocity_ma10.normal_data,
        #                                                              patch_sd_velocity_ma20.normal_data,
        #                                                              patch_sd_velocity_ma60.normal_data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        # 'structure/predefined_observation_ar': np.concatenate((patch_historical_ar.data,
        #                                                                 patch_historical_ar_ma5.data,
        #                                                                 patch_historical_ar_ma10.data,
        #                                                                 patch_historical_ar_ma20.data,
        #                                                                 patch_historical_ar_ma60.data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        'structure/predefined_observation_total': np.concatenate((patch_sd.normal_data,  # 0
                                                                  patch_sd_ma5.normal_data,
                                                                  patch_sd_ma10.normal_data,
                                                                  patch_sd_ma20.normal_data,
                                                                  patch_sd_ma60.normal_data,
                                                                  patch_sd_diff.normal_data,  # 5
                                                                  patch_sd_diff_ma5.normal_data,
                                                                  patch_sd_diff_ma10.normal_data,
                                                                  patch_sd_diff_ma20.normal_data,
                                                                  patch_sd_diff_ma60.normal_data,
                                                                  patch_sd_velocity.normal_data,  # 10
                                                                  patch_sd_velocity_ma5.normal_data,
                                                                  patch_sd_velocity_ma10.normal_data,
                                                                  patch_sd_velocity_ma20.normal_data,
                                                                  patch_sd_velocity_ma60.normal_data,
                                                                  patch_historical_ar.data,  # 15
                                                                  patch_historical_ar_ma5.data,
                                                                  patch_historical_ar_ma10.data,
                                                                  patch_historical_ar_ma20.data,
                                                                  patch_historical_ar_ma60.data,
                                                                  patch_sd.status_data5,  # 20
                                                                  patch_sd_ma5.status_data5,
                                                                  patch_sd_ma10.status_data5,
                                                                  patch_sd_ma20.status_data5,
                                                                  patch_sd_ma60.status_data5,
                                                                  # patch_sd.status_data5_Y,  # 25
                                                                  # patch_sd_ma5.status_data5_Y,
                                                                  # patch_sd_ma10.status_data5_Y,
                                                                  # patch_sd_ma20.status_data5_Y,
                                                                  # patch_sd_ma60.status_data5_Y,
                                                                  ), axis=0). \
            reshape((25, patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])),
        # # Todo: apply MlpLnlstm, later on
        # 'structure/predefined_observation_extra_cov': patch_extra_cov_60.data.reshape(
        #     (1, patch_extra_cov_60.data.shape[0], patch_extra_cov_60.data.shape[1])),
        # 'structure/class/seq_price': patch_sd.class_seq_price,
        'structure/class/seq_ratio': patch_sd.class_seq_ratio,
        'structure/class/base_date_price': patch_sd.base_date_price,
        # 'structure/class/seq_height': patch_sd.class_seq_height,
        # 'structure/class/seq_width': patch_sd.class_seq_width,
        'structure/class/label': patch_sd.class_label,
        'structure/class/label_ref1': patch_sd.class_label_ref1,
        'structure/class/label_ref2': patch_sd.class_label_ref2,
        'structure/class/label_ref3': patch_sd.class_label_ref3,
        'structure/class/label_ref4': patch_sd.class_label_ref4,
        'structure/class/label_ref5': patch_sd.class_label_ref5,
        'structure/class/index': patch_sd.class_index,
        'structure/class/ratio': patch_sd.class_ratio,
        'structure/class/ratio_ref0': patch_sd.class_ratio_ref0,
        'structure/class/ratio_ref1': patch_sd.class_ratio_ref1,
        'structure/class/ratio_ref2': patch_sd.class_ratio_ref2,
        'structure/class/ratio_ref3': patch_sd.class_ratio_ref3,
        'structure/class/ratio_ref4': patch_sd.class_ratio_ref4,
        'structure/class/ratio_ref5': patch_sd.class_ratio_ref5,
        'structure/class/ratio_ref6': patch_sd.class_ratio_ref6,
        'structure/class/ratio_ref7': patch_sd.class_ratio_ref7,
        # 'fund_his/cov60': patch_cov_60.data[-1],  # today correlation matrix
        # 'fund_his/data_cumsum30': patch_fund_his_30.data[-1],  # today cumulative sum returns
        # 'fund_his/height': patch_fund_his_30.height,
        # 'fund_his/width': patch_fund_his_30.width,
        'fund_his/patch_min': patch_fund_his_30.patch_min,
        'fund_his/patch_max': patch_fund_his_30.patch_max,
        'date/base_date_label': patch_sd.base_date_label,
        'date/base_date_index': patch_sd.base_date_index,
        'date/prediction_date_label': patch_sd.prediction_date_label,
        'date/prediction_date_index': patch_sd.prediction_date_index,
    }
    return feature


def pkexample_type_A(patch_sd, patch_sd_ma5, patch_sd_ma10, patch_sd_ma20, patch_sd_ma60,
                     patch_sd_diff, patch_sd_diff_ma5, patch_sd_diff_ma10, patch_sd_diff_ma20, patch_sd_diff_ma60,
                     patch_sd_velocity, patch_sd_velocity_ma5, patch_sd_velocity_ma10, patch_sd_velocity_ma20,
                     patch_sd_velocity_ma60,
                     patch_historical_ar, patch_historical_ar_ma5, patch_historical_ar_ma10,
                     patch_historical_ar_ma20,
                     patch_historical_ar_ma60,
                     patch_fund_his_30, patch_cov_60, patch_extra_cov_60, mask_reader, data_set_mode, *args):
    feature = {
        # 'structure/data': patch_sd.data,
        # 'structure/data_max': sd_max,
        # 'structure/data_min': sd_min,
        # 'structure/data_ma5': patch_sd_ma5.data,
        # 'structure/data_ma10': patch_sd_ma10.data,
        # 'structure/data_ma20': patch_sd_ma20.data,
        # 'structure/data_ma60': patch_sd_ma60.data,
        # 'structure/normal': patch_sd.normal_data,
        # 'structure/normal_ma5': patch_sd_ma5.normal_data,
        # 'structure/normal_ma10': patch_sd_ma10.normal_data,
        # 'structure/normal_ma20': patch_sd_ma20.normal_data,
        # 'structure/normal_ma60': patch_sd_ma60.normal_data,
        # 'structure/diff': patch_sd_diff.normal_data,
        # 'structure/diff_ma5': patch_sd_diff_ma5.normal_data,
        # 'structure/diff_ma10': patch_sd_diff_ma10.normal_data,
        # 'structure/diff_ma20': patch_sd_diff_ma20.normal_data,
        # 'structure/diff_ma60': patch_sd_diff_ma60.normal_data,
        # 'structure/velocity': patch_sd_velocity.normal_data,
        # 'structure/velocity_ma5': patch_sd_velocity_ma5.normal_data,
        # 'structure/velocity_ma10': patch_sd_velocity_ma10.normal_data,
        # 'structure/velocity_ma20': patch_sd_velocity_ma20.normal_data,
        # 'structure/velocity_ma60': patch_sd_velocity_ma60.normal_data,
        # 'structure/ar': patch_historical_ar.data,
        # 'structure/ar_ma5': patch_historical_ar_ma5.data,
        # 'structure/ar_ma10': patch_historical_ar_ma10.data,
        # 'structure/ar_ma20': patch_historical_ar_ma20.data,
        # 'structure/ar_ma60': patch_historical_ar_ma60.data,
        # 'structure/extra_cov': patch_extra_cov_60.data,
        # 'structure/height': patch_sd.height,
        # 'structure/width': patch_sd.width,

        # # predefined_observation for open-ai environments
        # 'structure/predefined_observation': np.concatenate((patch_sd.normal_data,
        #                                                     patch_sd_ma5.normal_data,
        #                                                     patch_sd_ma10.normal_data,
        #                                                     patch_sd_ma20.normal_data,
        #                                                     patch_sd_ma60.normal_data), axis=0). \
        #     reshape((5, patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])),
        # 'structure/predefined_observation_diff': np.concatenate((patch_sd_diff.normal_data,
        #                                                          patch_sd_diff_ma5.normal_data,
        #                                                          patch_sd_diff_ma10.normal_data,
        #                                                          patch_sd_diff_ma20.normal_data,
        #                                                          patch_sd_diff_ma60.normal_data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        # 'structure/predefined_observation_velocity': np.concatenate((patch_sd_velocity.normal_data,
        #                                                              patch_sd_velocity_ma5.normal_data,
        #                                                              patch_sd_velocity_ma10.normal_data,
        #                                                              patch_sd_velocity_ma20.normal_data,
        #                                                              patch_sd_velocity_ma60.normal_data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        # 'structure/predefined_observation_ar': np.concatenate((patch_historical_ar.data,
        #                                                                 patch_historical_ar_ma5.data,
        #                                                                 patch_historical_ar_ma10.data,
        #                                                                 patch_historical_ar_ma20.data,
        #                                                                 patch_historical_ar_ma60.data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        'structure/predefined_observation_total': np.concatenate((patch_sd.normal_data,  # 0
                                                                  patch_sd_ma5.normal_data,
                                                                  patch_sd_ma10.normal_data,
                                                                  patch_sd_ma20.normal_data,
                                                                  patch_sd_ma60.normal_data,
                                                                  patch_sd_diff.normal_data,  # 5
                                                                  patch_sd_diff_ma5.normal_data,
                                                                  patch_sd_diff_ma10.normal_data,
                                                                  patch_sd_diff_ma20.normal_data,
                                                                  patch_sd_diff_ma60.normal_data,
                                                                  # patch_sd_velocity.normal_data,  # 10
                                                                  # patch_sd_velocity_ma5.normal_data,
                                                                  # patch_sd_velocity_ma10.normal_data,
                                                                  # patch_sd_velocity_ma20.normal_data,
                                                                  # patch_sd_velocity_ma60.normal_data,
                                                                  # patch_historical_ar.data,  # 15
                                                                  # patch_historical_ar_ma5.data,
                                                                  # patch_historical_ar_ma10.data,
                                                                  # patch_historical_ar_ma20.data,
                                                                  # patch_historical_ar_ma60.data,
                                                                  patch_sd.status_data5,  # 20
                                                                  patch_sd_ma5.status_data5,
                                                                  patch_sd_ma10.status_data5,
                                                                  patch_sd_ma20.status_data5,
                                                                  patch_sd_ma60.status_data5,
                                                                  # patch_sd.status_data5_Y,  # 25
                                                                  # patch_sd_ma5.status_data5_Y,
                                                                  # patch_sd_ma10.status_data5_Y,
                                                                  # patch_sd_ma20.status_data5_Y,
                                                                  # patch_sd_ma60.status_data5_Y,
                                                                  ), axis=0). \
            reshape((15, patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])),
        # # Todo: apply MlpLnlstm, later on
        # 'structure/predefined_observation_extra_cov': patch_extra_cov_60.data.reshape(
        #     (1, patch_extra_cov_60.data.shape[0], patch_extra_cov_60.data.shape[1])),
        # 'structure/class/seq_price': patch_sd.class_seq_price,
        'structure/class/seq_ratio': patch_sd.class_seq_ratio,
        'structure/class/base_date_price': patch_sd.base_date_price,
        # 'structure/class/seq_height': patch_sd.class_seq_height,
        # 'structure/class/seq_width': patch_sd.class_seq_width,
        'structure/class/label': patch_sd.class_label,
        'structure/class/label_ref1': patch_sd.class_label_ref1,
        'structure/class/label_ref2': patch_sd.class_label_ref2,
        'structure/class/label_ref3': patch_sd.class_label_ref3,
        'structure/class/label_ref4': patch_sd.class_label_ref4,
        'structure/class/label_ref5': patch_sd.class_label_ref5,
        'structure/class/index': patch_sd.class_index,
        'structure/class/ratio': patch_sd.class_ratio,
        'structure/class/ratio_ref0': patch_sd.class_ratio_ref0,
        'structure/class/ratio_ref1': patch_sd.class_ratio_ref1,
        'structure/class/ratio_ref2': patch_sd.class_ratio_ref2,
        'structure/class/ratio_ref3': patch_sd.class_ratio_ref3,
        'structure/class/ratio_ref4': patch_sd.class_ratio_ref4,
        'structure/class/ratio_ref5': patch_sd.class_ratio_ref5,
        'structure/class/ratio_ref6': patch_sd.class_ratio_ref6,
        'structure/class/ratio_ref7': patch_sd.class_ratio_ref7,
        # 'fund_his/cov60': patch_cov_60.data[-1],  # today correlation matrix
        # 'fund_his/data_cumsum30': patch_fund_his_30.data[-1],  # today cumulative sum returns
        # 'fund_his/height': patch_fund_his_30.height,
        # 'fund_his/width': patch_fund_his_30.width,
        'fund_his/patch_min': patch_fund_his_30.patch_min,
        'fund_his/patch_max': patch_fund_his_30.patch_max,
        'date/base_date_label': patch_sd.base_date_label,
        'date/base_date_index': patch_sd.base_date_index,
        'date/prediction_date_label': patch_sd.prediction_date_label,
        'date/prediction_date_index': patch_sd.prediction_date_index,
        'dataset': data_set_mode,
    }
    return feature


def pkexample_type_B(patch_sd, patch_sd_ma5, patch_sd_ma10, patch_sd_ma20, patch_sd_ma60,
                     patch_sd_diff, patch_sd_diff_ma5, patch_sd_diff_ma10, patch_sd_diff_ma20, patch_sd_diff_ma60,
                     patch_sd_velocity, patch_sd_velocity_ma5, patch_sd_velocity_ma10, patch_sd_velocity_ma20,
                     patch_sd_velocity_ma60,
                     patch_historical_ar, patch_historical_ar_ma5, patch_historical_ar_ma10,
                     patch_historical_ar_ma20,
                     patch_historical_ar_ma60,
                     patch_fund_his_30, patch_cov_60, patch_extra_cov_60, mask_reader, data_set_mode, *args):
    feature = {
        # 'structure/data': patch_sd.data,
        # 'structure/data_max': sd_max,
        # 'structure/data_min': sd_min,
        # 'structure/data_ma5': patch_sd_ma5.data,
        # 'structure/data_ma10': patch_sd_ma10.data,
        # 'structure/data_ma20': patch_sd_ma20.data,
        # 'structure/data_ma60': patch_sd_ma60.data,
        # 'structure/normal': patch_sd.normal_data,
        # 'structure/normal_ma5': patch_sd_ma5.normal_data,
        # 'structure/normal_ma10': patch_sd_ma10.normal_data,
        # 'structure/normal_ma20': patch_sd_ma20.normal_data,
        # 'structure/normal_ma60': patch_sd_ma60.normal_data,
        # 'structure/diff': patch_sd_diff.normal_data,
        # 'structure/diff_ma5': patch_sd_diff_ma5.normal_data,
        # 'structure/diff_ma10': patch_sd_diff_ma10.normal_data,
        # 'structure/diff_ma20': patch_sd_diff_ma20.normal_data,
        # 'structure/diff_ma60': patch_sd_diff_ma60.normal_data,
        # 'structure/velocity': patch_sd_velocity.normal_data,
        # 'structure/velocity_ma5': patch_sd_velocity_ma5.normal_data,
        # 'structure/velocity_ma10': patch_sd_velocity_ma10.normal_data,
        # 'structure/velocity_ma20': patch_sd_velocity_ma20.normal_data,
        # 'structure/velocity_ma60': patch_sd_velocity_ma60.normal_data,
        # 'structure/ar': patch_historical_ar.data,
        # 'structure/ar_ma5': patch_historical_ar_ma5.data,
        # 'structure/ar_ma10': patch_historical_ar_ma10.data,
        # 'structure/ar_ma20': patch_historical_ar_ma20.data,
        # 'structure/ar_ma60': patch_historical_ar_ma60.data,
        # 'structure/extra_cov': patch_extra_cov_60.data,
        # 'structure/height': patch_sd.height,
        # 'structure/width': patch_sd.width,

        # # predefined_observation for open-ai environments
        # 'structure/predefined_observation': np.concatenate((patch_sd.normal_data,
        #                                                     patch_sd_ma5.normal_data,
        #                                                     patch_sd_ma10.normal_data,
        #                                                     patch_sd_ma20.normal_data,
        #                                                     patch_sd_ma60.normal_data), axis=0). \
        #     reshape((5, patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])),
        # 'structure/predefined_observation_diff': np.concatenate((patch_sd_diff.normal_data,
        #                                                          patch_sd_diff_ma5.normal_data,
        #                                                          patch_sd_diff_ma10.normal_data,
        #                                                          patch_sd_diff_ma20.normal_data,
        #                                                          patch_sd_diff_ma60.normal_data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        # 'structure/predefined_observation_velocity': np.concatenate((patch_sd_velocity.normal_data,
        #                                                              patch_sd_velocity_ma5.normal_data,
        #                                                              patch_sd_velocity_ma10.normal_data,
        #                                                              patch_sd_velocity_ma20.normal_data,
        #                                                              patch_sd_velocity_ma60.normal_data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        # 'structure/predefined_observation_ar': np.concatenate((patch_historical_ar.data,
        #                                                                 patch_historical_ar_ma5.data,
        #                                                                 patch_historical_ar_ma10.data,
        #                                                                 patch_historical_ar_ma20.data,
        #                                                                 patch_historical_ar_ma60.data), axis=0). \
        #     reshape((g_num_of_datatype_obs, g_x_seq, g_x_variables)),
        'structure/predefined_observation_total': np.multiply(np.concatenate((patch_sd.normal_data,  # 0 [spread - smoothing]
                                                                              patch_sd_ma5.normal_data,
                                                                              patch_sd_ma10.normal_data,
                                                                              patch_sd_ma20.normal_data,
                                                                              patch_sd_ma60.normal_data,
                                                                              patch_sd_diff.normal_data,  # 5 [velocity]
                                                                              patch_sd_diff_ma5.normal_data,
                                                                              patch_sd_diff_ma10.normal_data,
                                                                              patch_sd_diff_ma20.normal_data,
                                                                              patch_sd_diff_ma60.normal_data,
                                                                              patch_sd_velocity.data,  # 10 [spread - grained]
                                                                              patch_sd_velocity_ma5.data,
                                                                              patch_sd_velocity_ma10.data,
                                                                              patch_sd_velocity_ma20.data,
                                                                              patch_sd_velocity_ma60.data,
                                                                            #   patch_sd.status_data5,  # 15
                                                                            #   patch_sd_ma5.status_data5,
                                                                            #   patch_sd_ma10.status_data5,
                                                                            #   patch_sd_ma20.status_data5,
                                                                            #   patch_sd_ma60.status_data5,
                                                                              # patch_sd.status_data5_Y,  # 20
                                                                              # patch_sd_ma5.status_data5_Y,
                                                                              # patch_sd_ma10.status_data5_Y,
                                                                              # patch_sd_ma20.status_data5_Y,
                                                                              # patch_sd_ma60.status_data5_Y,
                                                                              ), axis=0). \
            reshape(
            (args[0], patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])), mask_reader.data) + 0,
        'structure/predefined_observation_ar': np.concatenate((patch_historical_ar.normal_data,  # 0
                                                               patch_historical_ar_ma5.normal_data,
                                                               patch_historical_ar_ma10.normal_data,
                                                               patch_historical_ar_ma20.normal_data,
                                                               patch_historical_ar_ma60.normal_data,
                                                               patch_historical_ar.normal_data_diff,  # 5
                                                               patch_historical_ar_ma5.normal_data_diff,
                                                               patch_historical_ar_ma10.normal_data_diff,
                                                               patch_historical_ar_ma20.normal_data_diff,
                                                               patch_historical_ar_ma60.normal_data_diff,
                                                               patch_historical_ar.data_diff,  # 10
                                                               patch_historical_ar_ma5.data_diff,
                                                               patch_historical_ar_ma10.data_diff,
                                                               patch_historical_ar_ma20.data_diff,
                                                               patch_historical_ar_ma60.data_diff,
                                                               patch_historical_ar_ma60.data_mu,  # 15
                                                               patch_historical_ar_ma60.data_sigma,
                                                               ), axis=0). \
            reshape(
            (args[1], patch_historical_ar.normal_data.shape[0], 1)),
        # # Todo: apply MlpLnlstm, later on
        # 'structure/predefined_observation_extra_cov': patch_extra_cov_60.data.reshape(
        #     (1, patch_extra_cov_60.data.shape[0], patch_extra_cov_60.data.shape[1])),
        # 'structure/class/seq_price': patch_sd.class_seq_price,
        'structure/class/seq_ratio': patch_sd.class_seq_ratio,
        'structure/class/base_date_price': patch_sd.base_date_price,
        # 'structure/class/seq_height': patch_sd.class_seq_height,
        # 'structure/class/seq_width': patch_sd.class_seq_width,
        'structure/class/label': patch_sd.class_label,
        'structure/class/label_ref1': patch_sd.class_label_ref1,
        'structure/class/label_ref2': patch_sd.class_label_ref2,
        'structure/class/label_ref3': patch_sd.class_label_ref3,
        'structure/class/label_ref4': patch_sd.class_label_ref4,
        'structure/class/label_ref5': patch_sd.class_label_ref5,
        'structure/class/tr_label_call': patch_sd.tr_class_label_call,
        'structure/class/tr_label_hold': patch_sd.tr_class_label_hold,
        'structure/class/tr_label_put': patch_sd.tr_class_label_put,
        'structure/class/index': patch_sd.class_index,
        'structure/class/tr_index': patch_sd.tr_class_index,
        'structure/class/ratio': patch_sd.class_ratio,
        'structure/class/ratio_ref0': patch_sd.class_ratio_ref0,
        'structure/class/ratio_ref1': patch_sd.class_ratio_ref1,
        'structure/class/ratio_ref2': patch_sd.class_ratio_ref2,
        'structure/class/ratio_ref3': patch_sd.class_ratio_ref3,
        'structure/class/ratio_ref4': patch_sd.class_ratio_ref4,
        'structure/class/ratio_ref5': patch_sd.class_ratio_ref5,
        'structure/class/ratio_ref6': patch_sd.class_ratio_ref6,
        'structure/class/ratio_ref7': patch_sd.class_ratio_ref7,
        # 'fund_his/cov60': patch_cov_60.data[-1],  # today correlation matrix
        # 'fund_his/data_cumsum30': patch_fund_his_30.data[-1],  # today cumulative sum returns
        # 'fund_his/height': patch_fund_his_30.height,
        # 'fund_his/width': patch_fund_his_30.width,
        'fund_his/patch_min': patch_fund_his_30.patch_min,
        'fund_his/patch_max': patch_fund_his_30.patch_max,
        'date/base_date_label': patch_sd.base_date_label,
        'date/base_date_index': patch_sd.base_date_index,
        'date/prediction_date_label': patch_sd.prediction_date_label,
        'date/prediction_date_index': patch_sd.prediction_date_index,
        'dataset': data_set_mode,
    }
    return feature

def pkexample_type_C(patch_sd, patch_sd_ma5, patch_sd_ma10, patch_sd_ma20, patch_sd_ma60,
                     patch_sd_diff, patch_sd_diff_ma5, patch_sd_diff_ma10, patch_sd_diff_ma20, patch_sd_diff_ma60,
                     patch_sd_velocity, patch_sd_velocity_ma5, patch_sd_velocity_ma10, patch_sd_velocity_ma20,
                     patch_sd_velocity_ma60,
                     patch_historical_ar, patch_historical_ar_ma5, patch_historical_ar_ma10,
                     patch_historical_ar_ma20,
                     patch_historical_ar_ma60,
                     patch_fund_his_30, patch_cov_60, patch_extra_cov_60, mask_reader, data_set_mode, *args):
    feature = {
        'structure/predefined_observation_total': np.multiply(np.concatenate((patch_sd.normal_data,  # 0 [spread - smoothing]
                                                                              patch_sd_ma5.normal_data,
                                                                              patch_sd_ma10.normal_data,
                                                                              patch_sd_ma20.normal_data,
                                                                              patch_sd_ma60.normal_data,
                                                                              patch_sd_diff.normal_data,  # 5 [velocity]
                                                                              patch_sd_diff_ma5.normal_data,
                                                                              patch_sd_diff_ma10.normal_data,
                                                                              patch_sd_diff_ma20.normal_data,
                                                                              patch_sd_diff_ma60.normal_data,
                                                                              patch_sd_velocity.data,  # 10 [spread - grained]
                                                                              patch_sd_velocity_ma5.data,
                                                                              patch_sd_velocity_ma10.data,
                                                                              patch_sd_velocity_ma20.data,
                                                                              patch_sd_velocity_ma60.data,
                                                                              patch_sd.wiliarms_R,  # 15
                                                                              patch_sd_ma5.wiliarms_R,
                                                                              patch_sd_ma10.wiliarms_R,
                                                                              patch_sd_ma20.wiliarms_R,
                                                                              patch_sd_ma60.wiliarms_R,
                                                                              # patch_sd.status_data5_Y,  # 20
                                                                              # patch_sd_ma5.status_data5_Y,
                                                                              # patch_sd_ma10.status_data5_Y,
                                                                              # patch_sd_ma20.status_data5_Y,
                                                                              # patch_sd_ma60.status_data5_Y,
                                                                              ), axis=0). \
            reshape(
            (args[0], patch_sd.normal_data.shape[0], patch_sd.normal_data.shape[1])), mask_reader.data) + 0,
        'structure/predefined_observation_ar': np.concatenate((patch_historical_ar.normal_data,  # 0
                                                               patch_historical_ar_ma5.normal_data,
                                                               patch_historical_ar_ma10.normal_data,
                                                               patch_historical_ar_ma20.normal_data,
                                                               patch_historical_ar_ma60.normal_data,
                                                               patch_historical_ar.normal_data_diff,  # 5
                                                               patch_historical_ar_ma5.normal_data_diff,
                                                               patch_historical_ar_ma10.normal_data_diff,
                                                               patch_historical_ar_ma20.normal_data_diff,
                                                               patch_historical_ar_ma60.normal_data_diff,
                                                               patch_historical_ar.data_diff,  # 10
                                                               patch_historical_ar_ma5.data_diff,
                                                               patch_historical_ar_ma10.data_diff,
                                                               patch_historical_ar_ma20.data_diff,
                                                               patch_historical_ar_ma60.data_diff,
                                                               patch_historical_ar_ma60.data_mu,  # 15
                                                               patch_historical_ar_ma60.data_sigma,
                                                               ), axis=0). \
            reshape(
            (args[1], patch_historical_ar.normal_data.shape[0], 1)),
        # # Todo: apply MlpLnlstm, later on
        # 'structure/predefined_observation_extra_cov': patch_extra_cov_60.data.reshape(
        #     (1, patch_extra_cov_60.data.shape[0], patch_extra_cov_60.data.shape[1])),
        # 'structure/class/seq_price': patch_sd.class_seq_price,
        'structure/class/seq_ratio': patch_sd.class_seq_ratio,
        'structure/class/base_date_price': patch_sd.base_date_price,
        # 'structure/class/seq_height': patch_sd.class_seq_height,
        # 'structure/class/seq_width': patch_sd.class_seq_width,
        'structure/class/label': patch_sd.class_label,
        'structure/class/label_ref1': patch_sd.class_label_ref1,
        'structure/class/label_ref2': patch_sd.class_label_ref2,
        'structure/class/label_ref3': patch_sd.class_label_ref3,
        'structure/class/label_ref4': patch_sd.class_label_ref4,
        'structure/class/label_ref5': patch_sd.class_label_ref5,
        'structure/class/tr_label_call': patch_sd.tr_class_label_call,
        'structure/class/tr_label_hold': patch_sd.tr_class_label_hold,
        'structure/class/tr_label_put': patch_sd.tr_class_label_put,
        'structure/class/index': patch_sd.class_index,
        'structure/class/tr_index': patch_sd.tr_class_index,
        'structure/class/ratio': patch_sd.class_ratio,
        'structure/class/ratio_ref0': patch_sd.class_ratio_ref0,
        'structure/class/ratio_ref1': patch_sd.class_ratio_ref1,
        'structure/class/ratio_ref2': patch_sd.class_ratio_ref2,
        'structure/class/ratio_ref3': patch_sd.class_ratio_ref3,
        'structure/class/ratio_ref4': patch_sd.class_ratio_ref4,
        'structure/class/ratio_ref5': patch_sd.class_ratio_ref5,
        'structure/class/ratio_ref6': patch_sd.class_ratio_ref6,
        'structure/class/ratio_ref7': patch_sd.class_ratio_ref7,
        # 'fund_his/cov60': patch_cov_60.data[-1],  # today correlation matrix
        # 'fund_his/data_cumsum30': patch_fund_his_30.data[-1],  # today cumulative sum returns
        # 'fund_his/height': patch_fund_his_30.height,
        # 'fund_his/width': patch_fund_his_30.width,
        'fund_his/patch_min': patch_fund_his_30.patch_min,
        'fund_his/patch_max': patch_fund_his_30.patch_max,
        'date/base_date_label': patch_sd.base_date_label,
        'date/base_date_index': patch_sd.base_date_index,
        'date/prediction_date_label': patch_sd.prediction_date_label,
        'date/prediction_date_index': patch_sd.prediction_date_index,
        'dataset': data_set_mode,
    }
    return feature
